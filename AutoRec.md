---
typora-copy-images-to: upload
---

# AutoRec-单隐层神经网络推荐模型

​	AutoRec将⾃编码器（AutoEncoder）的思想和协同过滤结合，提出了⼀种单隐层神经⽹络推荐模型。

### 基础知识-自编码器

​	自编码器是一种通过无监督学习方式来学习数据有效表示的神经网络模型。其核心思想是通过编码器将输入数据压缩成低维潜在表示，然后通过解码器从该表示中重构出原始输入数据。自编码器在数据降维、特征提取、数据去噪、异常检测以及生成模型等领域均展现出卓越的性能。

​	⽆论是图像、⾳频，还是数据，都可以转换成向量的形式进⾏表达。假设其数据向量为 *r*，⾃编码器的作⽤是将向量*r*作为输⼊，通过⾃编码器后，得到的输出向量尽量接近其本⾝。

<img src="https://raw.githubusercontent.com/ahscbkbkjd/-Picture/main/屏幕截图 2025-03-11 162752.png" alt="屏幕截图 2025-03-11 162752" style="zoom:50%;" />

​	假设⾃编码器的重建函数为$h(r;\theta)$，那么⾃编码器的⽬标函数如下式所⽰：
$$
\min x \sum_{r\in S}^{} \left \| r-h(r;\theta) \right \| _{2}^{2}
$$
​	其中，S是所有数据向量的集合。

​	在完成⾃编码器的训练后，就相当于在重建函数*$h(r;\theta)$*中存储了所有数据向量的“精华”。⼀般来说，重建函数的参数数量远⼩于输⼊向量的维度数量，因此⾃编码器相当于完成了数据压缩和降维的⼯作。经过⾃编码器⽣成的输出向量，由于经过了⾃编码器的“泛化”过程，不会完全等同于输⼊向量，也因此具备了⼀定的缺失维度的预测能⼒，这也是⾃编码器能⽤于推荐系统的原因。（编码维度为一超参数）

### AutoRec模型

​	假设有*m*个⽤户，*n*个物品，⽤户会对*n*个物品中的⼀个或⼏个进⾏评分，未评分的物品分值可⽤默认值或平均分值表⽰，则所有*m*个⽤户对物品的评分可形成⼀个*m*×*n*维的评分矩阵，也就是协同过滤中的共现矩阵。

​	对⼀个物品 i 来说，所有 *m* 个⽤户对它的评分可形成⼀个 *m* 维的向量$r^{(i)}=\left ( R_{1i},\dots , R_{mi} \right )  $，AutoRec 要解决的问题是构建⼀个重建函数$h(r;\theta)$，使所有该重建函数⽣成的评分向量与原评分向量的平⽅残差和最⼩。

​	AutoRec是一个非常标准的三层神经网络，输入层是物品的评分向量r，k维单隐层（k<<m），输出层是一个多分类层，模型的训练利用梯度反向传播。

​	基于AutoRec模型的推荐过程并不复杂。当输⼊物品i的评分向量为$r^{(i)}$时，模型的输出向量**$h(r^{(i)};\theta)$就是所有⽤户对物品 i 的评分

预测。那么，其中的第 u维就是⽤户u对物品i的预测 : 
$$
\hat{R} _{ui} = \left ( h\left ( r^{(i)};\hat{\theta} \right )  \right )
$$
​	通过遍历输⼊物品向量就可以得到⽤户u对所有物品的评分预测，进⽽根据评分预测排序得到推荐列表。AutoRec也分为基于物品的 AutoRec和基于⽤户的AutoRec。以上介绍的AutoRec输⼊向量是物品的评分向量，因此可称为I-AutoRec（Item based AutoRec），如果换做把⽤户的评分向量作为输⼊向量，则得到 U-AutoRec （User based AutoRec）。在进⾏推荐列表⽣成的过程中，U-AutoRec 相⽐ I-AutoRec 的优势在于仅需输⼊⼀次⽬标⽤户的⽤户向量，就可以重建⽤户对所有物品的评分向量。也就是说，得到⽤户的推荐列表仅需⼀次模型推断过程；其劣势是⽤户向量的稀疏性可能会影响模型效果。

### 模型的特点和局限性

​	AutoRec模型从神经⽹络的⾓度出发，使⽤⼀个单隐层的 AutoEncoder泛化⽤户或物品评分，使模型具有⼀定的泛化和表达能⼒。由于AutoRec模型的结构⽐较简单，使其存在⼀定的表达能⼒不⾜的问题。在模型结构上，AutoRec模型和后来的词向量模型（Word2vec）完全⼀致，但优化⽬标和训练⽅法有所不同。



参考文章：

https://blog.csdn.net/mieshizhishou/article/details/141422922

《深度学习推荐系统》（王喆）
